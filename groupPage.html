<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Group Page</title>
    <style>
        #member-list {
            margin-top: 20px;
        }

        .member {
            padding: 10px;
            margin-bottom: 5px;
            background-color: #f9f9f9;
            border-radius: 5px;
        }

        .money {
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>My Group </h1>
    <p id="current-user-info"></p>

    <h2>Group Members:</h2>
    <div id="member-list"></div>

    <h2> Our expenses: </h2>
    <div id = "costs"></div>
    <button id = addCost> Add expense </button>

    <script>
        const currentUser = localStorage.getItem("currentUser");
        const users = localStorage.getItem("users");

        const currentUserEmail = JSON.parse(users)[currentUser]?.email;

        if (!currentUser || !currentUserEmail) {
            alert("You must be logged in to view this page!");
            window.location.href = 'index.html';
        }

        const urlParams = new URLSearchParams(window.location.search);
        const groupCode = urlParams.get("groupCode");

        const userGroups = JSON.parse(localStorage.getItem("userGroups"));
        if (!userGroups || !userGroups[groupCode]) {
            alert("Group not found!");
            window.location.href = 'myGroups.html';
        }

        const groupData = userGroups[groupCode];
        const groupName = groupData[0][1];

        document.getElementById("current-user-info").textContent = `You are currently viewing ${groupName}  and you owe $${groupData.reduce((sum, userInfo) => userInfo[0] === currentUserEmail ? sum + userInfo[2] : sum, 0)}`;

        const memberListContainer = document.getElementById("member-list");
        groupData.forEach(member => {
            const memberElement = document.createElement("div");
            memberElement.classList.add("member");
            memberElement.innerHTML = `<p>${member[0]}</p>`;
            memberListContainer.appendChild(memberElement);
        });
    </script>
</body>
</html>
